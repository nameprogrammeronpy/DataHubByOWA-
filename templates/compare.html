{% extends "base.html" %}

{% block title %}Сравнение университетов — DataHub ВУЗ-ов РК{% endblock %}

{% block content %}
<!-- Compare Hero -->
<section class="compare-hero">
    <div class="container">
        <div class="compare-hero-content">
            <h1><i class="fas fa-balance-scale"></i> Сравнение университетов</h1>
            <p>Выберите до 4 университетов для детального сравнения по всем параметрам</p>
            <div class="compare-selected-count">
                Выбрано: <span id="selectedCount">0</span> / 4
            </div>
        </div>
    </div>
</section>

<!-- Floating Compare Button -->
<div id="floatingCompareBtn" class="floating-compare-btn">
    <button onclick="scrollToCompareTable()">
        <i class="fas fa-arrow-down"></i>
        <span>Смотреть сравнение</span>
        <span class="floating-count" id="floatingCount">2</span>
    </button>
</div>

<!-- University Selector -->
<section class="compare-selector-section">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Выберите университеты</h2>
            <button class="btn-clear-all" onclick="clearAllSelection()">
                <i class="fas fa-trash-alt"></i> Очистить все
            </button>
        </div>
        <div class="selector-grid">
            {% for uni in universities %}
            <div class="selector-card" data-id="{{ uni.id }}" onclick="toggleUniversitySelect({{ uni.id }}, '{{ uni.name_ru }}', this)">
                <div class="selector-card-check">
                    <i class="fas fa-check"></i>
                </div>
                <h4>{{ uni.name_ru }}</h4>
                <div class="selector-card-meta">
                    <span><i class="fas fa-map-marker-alt"></i> {{ uni.city }}</span>
                    <span><i class="fas fa-star"></i> {{ uni.rating }}</span>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Compare Table -->
<section class="compare-table-section" id="compareResults">
    <div class="container">
        <h2 class="section-title">Результаты сравнения</h2>
        <div id="compareTableContainer">
            <div class="compare-empty-state">
                <div class="empty-icon">
                    <i class="fas fa-balance-scale"></i>
                </div>
                <h3>Выберите университеты для сравнения</h3>
                <p>Нажмите на карточки университетов выше, чтобы добавить их к сравнению (минимум 2)</p>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        initComparePage();
        updateSelectedCount();
        updateFloatingButton();
    });

    function scrollToCompareTable() {
        document.getElementById('compareResults').scrollIntoView({
            behavior: 'smooth',
            block: 'start'
        });
    }

    function updateFloatingButton() {
        const btn = document.getElementById('floatingCompareBtn');
        const count = document.getElementById('floatingCount');

        if (compareList.length >= 2) {
            btn.classList.add('visible');
            count.textContent = compareList.length;
        } else {
            btn.classList.remove('visible');
        }
    }
</script>
{% endblock %}

